"use strict";Object.defineProperty(exports,"__esModule",{value:true});var e=require("prop-types");var t=require("react-router");var r=require("react");var n=require("react-dom");var o=require("react-transition-group");function a(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var i=a(e);var u=a(r);function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function c(e,t){return t={exports:{}},e(t,t.exports),t.exports}var l=c((function(e){function t(e,t){if(e==null)return{};var r={};var n=Object.keys(e);var o,a;for(a=0;a<n.length;a++){o=n[a];if(t.indexOf(o)>=0)continue;r[o]=e[o]}return r}e.exports=t,e.exports.__esModule=true,e.exports["default"]=e.exports}));s(l);var f=l;var p=c((function(e){function t(e,t){if(e==null)return{};var r=f(e,t);var n,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++){n=a[o];if(t.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;r[n]=e[n]}}return r}e.exports=t,e.exports.__esModule=true,e.exports["default"]=e.exports}));var d=s(p);var v=c((function(e){function t(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}e.exports=t,e.exports.__esModule=true,e.exports["default"]=e.exports}));s(v);var b=v;var m=c((function(e){function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.exports=r,e.exports.__esModule=true,e.exports["default"]=e.exports}));var y=s(m);var x=["parentMatches","routes"];var O=typeof window==="undefined";var h={key:"",isPush:true};var g="REACT_HISTORIES_KEY";var j=O?[]:(sessionStorage.getItem(g)||"").split(",").filter(Boolean);var E=function e(t,r){if(O){return true}var n=t.key||t.pathname+t.search;if(r&&n!==h.key){var o=j.lastIndexOf(n);var a=o<0||o+1===j.length;if(a){j.push(n)}else{j.splice(o+1)}sessionStorage.setItem(g,j.join(","));h={isPush:a,key:n}}return h.isPush};var P=function e(t){var r=t.parentMatches,n=t.routes,o=d(t,x);return T(n,o,r)};function T(e,a){var i=t.useLocation();var s=r.useRef(null);var c=arguments[2];var l=a||{},f=l.className,p=l.timeout,d=l.prefix,v=d===void 0?"animated-router":d,b=l.appear,m=l.enter,x=l.exit,h=l.transitionKey,g=l.component,j=l.location,T=j===void 0?i:j;var w=r.useRef({inTransition:false}).current;if(typeof T==="string"){T=t.parsePath(T)}var k=r.useMemo((function(){return c||t.matchRoutes(e,T)}),[T,e,c])||[];var N=k.findIndex((function(t){return e.includes(t.route)}));if(!h&&N>-1){h="".concat(e.indexOf(k[N].route),"_").concat(k[N].pathname)}var _=t.useRoutes(e.map((function(e){var t;if((t=e.children)!==null&&t!==void 0&&t.length){var r=u["default"].createElement(P,Object.assign({},a,{routes:e.children,location:T,parentMatches:k}));return y(y({},e),{},{children:[{element:r,children:e.children}]})}return e})),T);var M=r.useCallback((function(e){if(w.rootNode){var t="".concat(v,"-in-transition");w.rootNode.className=w.rootNode.className.split(/\s+/).filter((function(e){return e!==t})).concat(e?t:[]).join(" ")}}),[v,w]);var D=r.useCallback((function(e){w.inTransition||M(w.inTransition=true);w.lastTransitionNode=e}),[w,M]);var S=r.useCallback((function(e){if(e&&typeof p==="number"){e.style.transitionDuration=e.style.WebkitTransitionDuration=e.style.MozTransitionDuration="".concat(p,"ms")}}),[p]);var R=r.useCallback((function(e){if(w.lastTransitionNode===e){w.inTransition&&M(w.inTransition=false)}if(e){e.className=e.className.split(/\s+/).filter((function(e){return!/-(?:forward|backward)-(?:enter|exit|appear)(?:-active|-done)?$/.test(e)})).join(" ");if(typeof p==="number"){e.style.transitionDuration=e.style.WebkitTransitionDuration=e.style.MozTransitionDuration=""}}}),[w,M,p]);var C={appear:b,enter:m,exit:x,component:g};var I={onExit:D,onExiting:S,onExited:R,onEnter:D,onEntering:S,onEntered:R};var q=["".concat(v,"-container"),"react-animated-router",f];r.useEffect((function(){w.rootNode=n.findDOMNode(s.current)}),[w]);if(O||!_){return _}return u["default"].createElement(o.TransitionGroup,Object.assign({ref:s,className:q.filter(Boolean).join(" "),childFactory:function e(t){var r="".concat(v,"-").concat(E(T,t.props.in)?"forward":"backward");return u["default"].cloneElement(t,{classNames:r})}},C),u["default"].createElement(o.CSSTransition,Object.assign({key:h||T.pathname,addEndListener:function e(t,r){t.addEventListener("transitionend",(function(e){if(e.target===t){r()}}),false)},unmountOnExit:true,timeout:p},I),_))}var w=["children"];var k=function e(r){var n=r.children,o=d(r,w);var a=t.createRoutesFromChildren(n);return T(a,o)};k.propTypes={className:i["default"].string,transitionKey:i["default"].oneOfType([i["default"].string,i["default"].number]),timeout:i["default"].number,prefix:i["default"].string,appear:i["default"].bool,enter:i["default"].bool,exit:i["default"].bool,component:i["default"].any,children:i["default"].node};k.defaultProps={prefix:"animated-router"};exports["default"]=k;exports.useAnimatedRoutes=T;
