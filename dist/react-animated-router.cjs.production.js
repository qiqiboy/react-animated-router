"use strict";Object.defineProperty(exports,"__esModule",{value:true});var e=require("prop-types");var t=require("react-router");var r=require("react");var n=require("react-dom");var a=require("react-transition-group");function o(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var i=o(e);var u=o(r);function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function c(e,t){return t={exports:{}},e(t,t.exports),t.exports}var l=c((function(e){function t(e,t){if(e==null)return{};var r={};var n=Object.keys(e);var a,o;for(o=0;o<n.length;o++){a=n[o];if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}e.exports=t,e.exports.__esModule=true,e.exports["default"]=e.exports}));s(l);var f=l;var p=c((function(e){function t(e,t){if(e==null)return{};var r=f(e,t);var n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++){n=o[a];if(t.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;r[n]=e[n]}}return r}e.exports=t,e.exports.__esModule=true,e.exports["default"]=e.exports}));var d=s(p);var v=c((function(e){function t(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}e.exports=t,e.exports.__esModule=true,e.exports["default"]=e.exports}));s(v);var m=v;var b=c((function(e){function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.exports=r,e.exports.__esModule=true,e.exports["default"]=e.exports}));var y=s(b);var x=r.createContext({parentMatches:null,parentBase:""});var O=["routes"];var h=typeof window==="undefined";var g={key:"",isPush:true};var j="REACT_HISTORIES_KEY";var E=h?[]:(sessionStorage.getItem(j)||"").split(",").filter(Boolean);var P=function e(t,r){if(h){return true}var n=t.key||t.pathname+t.search;if(r&&n!==g.key){var a=E.lastIndexOf(n);var o=a<0||a+1===E.length;if(o){E.push(n)}else{E.splice(a+1)}sessionStorage.setItem(j,E.join(","));g={isPush:o,key:n}}return g.isPush};var T=function e(t){var r=t.routes,n=d(t,O);return w(r,n,true)};function w(e,o){var i=arguments[2];var s=t.useLocation();var c=r.useRef(null);var l=r.useContext(x),f=l.parentMatches,p=l.parentBase,d=l.location;var v=o||{},m=v.className,b=v.timeout,O=v.prefix,g=O===void 0?"animated-router":O,j=v.appear,E=v.enter,w=v.exit,k=v.transitionKey,N=v.component,_=v.location,M=_===void 0?d||s:_;var D=r.useRef({inTransition:false}).current;if(typeof M==="string"){M=t.parsePath(M)}var S=r.useMemo((function(){var r;if(i){return f}p=[p,f===null||f===void 0?void 0:(r=f[f.length-1])===null||r===void 0?void 0:r.pathnameBase].filter(Boolean).join("/").replace(/\/\/+/g,"/");return t.matchRoutes(e,M,p)}),[M,e,f,i])||[];var C=S.findIndex((function(t){return e.includes(t.route)}));if(!k&&C>-1){k="".concat(e.indexOf(S[C].route),"_").concat(S[C].pathnameBase)}var B=u["default"].createElement(x.Provider,{value:{parentMatches:S,parentBase:p,location:M}},t.useRoutes(e.map((function(e){var t;if((t=e.children)!==null&&t!==void 0&&t.length){var r=u["default"].createElement(T,Object.assign({},o,{routes:e.children,location:M}));return y(y({},e),{},{children:[{element:r,children:e.children}]})}return e})),M));var R=r.useCallback((function(e){if(D.rootNode){var t="".concat(g,"-in-transition");D.rootNode.className=D.rootNode.className.split(/\s+/).filter((function(e){return e!==t})).concat(e?t:[]).join(" ")}}),[g,D]);var I=r.useCallback((function(e){D.inTransition||R(D.inTransition=true);D.lastTransitionNode=e}),[D,R]);var q=r.useCallback((function(e){if(e&&typeof b==="number"){e.style.transitionDuration=e.style.WebkitTransitionDuration=e.style.MozTransitionDuration="".concat(b,"ms")}}),[b]);var K=r.useCallback((function(e){if(D.lastTransitionNode===e){D.inTransition&&R(D.inTransition=false)}if(e){e.className=e.className.split(/\s+/).filter((function(e){return!/-(?:forward|backward)-(?:enter|exit|appear)(?:-active|-done)?$/.test(e)})).join(" ");if(typeof b==="number"){e.style.transitionDuration=e.style.WebkitTransitionDuration=e.style.MozTransitionDuration=""}}}),[D,R,b]);var L={appear:j,enter:E,exit:w,component:N};var z={onExit:I,onExiting:q,onExited:K,onEnter:I,onEntering:q,onEntered:K};var A=["".concat(g,"-container"),"react-animated-router",m];r.useEffect((function(){D.rootNode=n.findDOMNode(c.current)}),[D]);if(h){return B}return u["default"].createElement(a.TransitionGroup,Object.assign({ref:c,className:A.filter(Boolean).join(" "),childFactory:function e(t){var r="".concat(g,"-").concat(P(M,t.props.in)?"forward":"backward");return u["default"].cloneElement(t,{classNames:r})}},L),u["default"].createElement(a.CSSTransition,Object.assign({key:k||M.pathname,addEndListener:function e(t,r){t.addEventListener("transitionend",(function(e){if(e.target===t){r()}}),false)},unmountOnExit:true,timeout:b},z),B))}var k=["children"];var N=function e(r){var n=r.children,a=d(r,k);var o=t.createRoutesFromChildren(n);return w(o,a)};N.propTypes={className:i["default"].string,transitionKey:i["default"].oneOfType([i["default"].string,i["default"].number]),timeout:i["default"].number,prefix:i["default"].string,appear:i["default"].bool,enter:i["default"].bool,exit:i["default"].bool,component:i["default"].any,children:i["default"].node};N.defaultProps={prefix:"animated-router"};exports["default"]=N;exports.useAnimatedRoutes=w;
