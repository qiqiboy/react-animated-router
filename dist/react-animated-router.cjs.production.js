"use strict";Object.defineProperty(exports,"__esModule",{value:true});var e=require("prop-types");var t=require("react-router");var r=require("react");var n=require("react-dom");var a=require("react-transition-group");function o(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var i=o(e);var u=o(r);function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function c(e,t){return t={exports:{}},e(t,t.exports),t.exports}var l=c((function(e){function t(e,t){if(e==null)return{};var r={};var n=Object.keys(e);var a,o;for(o=0;o<n.length;o++){a=n[o];if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}e.exports=t,e.exports.__esModule=true,e.exports["default"]=e.exports}));s(l);var f=l;var p=c((function(e){function t(e,t){if(e==null)return{};var r=f(e,t);var n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++){n=o[a];if(t.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;r[n]=e[n]}}return r}e.exports=t,e.exports.__esModule=true,e.exports["default"]=e.exports}));var d=s(p);var v=c((function(e){function t(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}e.exports=t,e.exports.__esModule=true,e.exports["default"]=e.exports}));s(v);var b=v;var m=c((function(e){function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.exports=r,e.exports.__esModule=true,e.exports["default"]=e.exports}));var y=s(m);var x=["parentMatches","routes"];var O=typeof window==="undefined";var h={key:"",isPush:true};var g="REACT_HISTORIES_KEY";var j=O?[]:(sessionStorage.getItem(g)||"").split(",").filter(Boolean);var T=function e(t,r){if(O){return true}var n=t.key||t.pathname+t.search;if(r&&n!==h.key){var a=j.lastIndexOf(n);if(a>-1){j.splice(a+1)}else{j.push(n)}sessionStorage.setItem(g,j.join(","));h={isPush:a<0,key:n}}return h.isPush};var E=function e(t){var r=t.parentMatches,n=t.routes,a=d(t,x);return P(n,a,r)};function P(e,o,i){var s=t.useLocation();var c=r.useRef(null);var l=o||{},f=l.className,p=l.timeout,d=l.prefix,v=d===void 0?"animated-router":d,b=l.appear,m=l.enter,x=l.exit,h=l.transitionKey,g=l.component,j=l.location,P=j===void 0?s:j;var w=r.useRef({inTransition:false,inAppearTransition:!!b}).current;if(typeof P==="string"){P=t.parsePath(P)}var k=r.useMemo((function(){return i||t.matchRoutes(e,P)}),[P,e,i])||[];var N=k.findIndex((function(t){return e.includes(t.route)}));if(!h&&N>-1){h="".concat(e.indexOf(k[N].route),"_").concat(k[N].pathname)}var _=t.useRoutes(e.map((function(e){var t;if((t=e.children)!==null&&t!==void 0&&t.length){var r=u["default"].createElement(E,Object.assign({},o,{routes:e.children,location:P,parentMatches:k}));return y(y({},e),{},{children:[{element:r,children:e.children}]})}return e})),P);var M=r.useCallback((function(e){if(w.rootNode){var t="".concat(v,"-in-transition");w.rootNode.className=w.rootNode.className.split(/\s+/).filter((function(e){return e!==t})).concat(e?t:[]).join(" ")}}),[v,w]);var D=r.useCallback((function(e){w.inTransition||M(w.inTransition=true);w.lastTransitionNode=e}),[w,M]);var S=r.useCallback((function(e){if(e&&typeof p==="number"){e.style.transitionDuration=e.style.WebkitTransitionDuration=e.style.MozTransitionDuration="".concat(p,"ms")}}),[p]);var R=r.useCallback((function(e){if(w.lastTransitionNode===e){w.inTransition&&M(w.inTransition=false)}if(w.inAppearTransition){w.inAppearTransition=false}if(e){e.className=e.className.split(/\s+/).filter((function(e){return!/-(?:forward|backward)-(?:enter|exit)(?:-active)?$/.test(e)})).join(" ");if(typeof p==="number"){e.style.transitionDuration=e.style.WebkitTransitionDuration=e.style.MozTransitionDuration=""}}}),[w,M,p]);var C={appear:b,enter:m,exit:x,component:g};var I={onExit:D,onExiting:S,onExited:R,onEnter:D,onEntering:S,onEntered:R};var A=["".concat(v,"-container"),"react-animated-router",f];r.useEffect((function(){w.rootNode=n.findDOMNode(c.current)}),[w]);if(O||!_){return _}return u["default"].createElement(a.TransitionGroup,Object.assign({ref:c,className:A.filter(Boolean).join(" "),childFactory:function e(t){var r="".concat(v,"-").concat(T(P,w.inAppearTransition?false:t.props.in)?"forward":"backward");return u["default"].cloneElement(t,{classNames:r})}},C),u["default"].createElement(a.CSSTransition,Object.assign({key:h||P.pathname,addEndListener:function e(t,r){t.addEventListener("transitionend",(function(e){if(e.target===t){r()}}),false)},unmountOnExit:true,timeout:p},I),_))}var w=["children"];var k=function e(r){var n=r.children,a=d(r,w);var o=t.createRoutesFromChildren(n);return P(o,a)};k.propTypes={className:i["default"].string,transitionKey:i["default"].oneOfType([i["default"].string,i["default"].number]),timeout:i["default"].number,prefix:i["default"].string,appear:i["default"].bool,enter:i["default"].bool,exit:i["default"].bool,component:i["default"].any,children:i["default"].node};k.defaultProps={prefix:"animated-router"};exports["default"]=k;exports.useAnimatedRoutes=P;
